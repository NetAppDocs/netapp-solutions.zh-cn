---
sidebar: sidebar 
permalink: virtualization/vsphere_ontap_ontap_capabilities_for_vsphere.html 
keywords: protocols, licensing, virtualization, NFS Plug-In for VMware VAAI, VASA Provider, Storage Replication Adapter 
summary: ONTAP 支持用于虚拟化的所有主要存储协议，例如 iSCSI ，光纤通道（ FC ），以太网光纤通道（ FCoE ）或适用于 SAN 环境的非易失性光纤通道快速内存（ NVMe/FC ），以及 NFS （ v3 和 v4.1 ）和 SMB 或 S3 （用于子系统连接）。客户可以自由选择最适合其环境的协议，并可以根据需要在一个系统上组合协议。 
---
= 适用于 vSphere 的 ONTAP 功能
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/




== 协议

ONTAP 支持用于虚拟化的所有主要存储协议，例如 iSCSI ，光纤通道（ FC ），以太网光纤通道（ FCoE ）或适用于 SAN 环境的非易失性光纤通道快速内存（ NVMe/FC ），以及 NFS （ v3 和 v4.1 ）和 SMB 或 S3 （用于子系统连接）。客户可以自由选择最适合其环境的协议，并可以根据需要在一个系统上组合使用协议（例如，使用几个 iSCSI LUN 或子系统共享来扩大 NFS 数据存储库的常规使用）。



== 功能

许多 ONTAP 功能可用于管理虚拟化工作负载。下一节将介绍一些需要附加产品许可证的软件。之后将介绍其他打包为独立工具的工具，其中一些用于 ONTAP ，另一些用于整个 NetApp 产品组合。

下面是有关基本 ONTAP 功能的更多详细信息：

* * NetApp Snapshot 副本。 * 创建或使用 Snapshot 副本时， ONTAP 可为 VM 或数据存储库提供即时 Snapshot 副本，而不会影响性能。它们可用于在修补之前为 VM 创建还原点，或者用于简单的数据保护。请注意，这些快照与 VMware （一致性）快照不同。创建 ONTAP Snapshot 副本的最简单方法是使用适用于 VMware vSphere 的 SnapCenter 插件备份 VM 和数据存储库。
* * 存储效率。 * ONTAP 支持实时和后台重复数据删除和数据压缩，零块重复数据删除和数据缩减。
* * 卷和 LUN 移动。 * 允许在 ONTAP 集群中无中断移动支持 vSphere 数据存储库和 VVol 的卷和 LUN ，以平衡性能和容量，或支持无中断维护和升级。
* 通过 * QoS 。 * QoS ，可以管理单个 LUN ，卷或文件的性能。此功能可用于限制未知或抢占资源的 VM ，或者确保重要的 VM 获得足够的性能资源。
* * NetApp 卷加密， NetApp 聚合加密。 * NetApp 加密选项提供基于软件的简单加密，可保护空闲数据。
* * FabricPool 。 * 此功能可在块级别自动将较冷的数据分层到单独的对象存储中，从而腾出昂贵的闪存存储。
* * REST ， Ansible 。 * 使用 https://devnet.netapp.com/restapi["ONTAP REST API"^] 自动执行存储和数据管理，以及 https://netapp.io/configuration-management-and-automation/["Ansible 模块"^] 用于 ONTAP 系统的配置管理。请注意，某些 ONTAP 功能不适合 vSphere 工作负载。例如， ONTAP 9.8 之前的 FlexGroup 不支持完全克隆，也未在 vSphere 中进行测试（请参见 FlexGroup 一节，了解有关将其与 vSphere 结合使用的最新信息）。FlexCache 也不是 vSphere 的最佳选择，因为它专为大多数读取工作负载而设计。如果缓存与原始数据存储库断开连接，则写入可能会出现问题，从而导致两端出现 NFS 数据存储库错误。




== ONTAP 许可

对于管理虚拟化工作负载而言，某些 ONTAP 功能非常重要，因此需要额外的许可证，无论是以免费方式提供，还是以许可证包形式提供，还是按单点提供。对于许多客户来说，最经济高效的方法是使用许可证包。以下是与 vSphere 相关的关键许可证及其使用方式：

* * FlexClone 。 * FlexClone 支持对 ONTAP 卷和文件进行节省空间的即时克隆。如果 VMware vSphere 存储 API —阵列集成（ VAAI ）将操作卸载到存储系统，用于备份验证和恢复（ SnapCenter 软件）以及 VVOL 克隆和 Snapshot 副本，则会使用此克隆。以下是如何使用它们：
+
** ONTAP 支持使用 VAAI 卸载副本，以支持 vSphere 克隆和迁移（ Storage vMotion ）操作。FlexClone 许可证允许在 NetApp FlexVol 卷中快速克隆，但如果未获得许可，它仍允许使用较慢的块副本进行克隆。
** VVOL 功能需要 FlexClone 许可证。它支持在单个数据存储库中或数据存储库之间克隆 VVOL ，并支持 vSphere 管理的 VVOL Snapshot 副本，这些副本会卸载到存储系统中。


* 存储复制适配器（ SRA ）与 VMware Site Recovery Manager 结合使用，要在 NAS 和 SAN 环境中测试恢复，需要 FlexClone 许可证。在没有 FlexClone 的情况下，可以使用 SRA 执行发现，恢复和重新保护工作流。
* * SnapRestore 。 * SnapRestore 技术支持即时恢复卷，而无需复制数据。NetApp 备份和恢复工具（例如 SnapCenter ）需要使用该工具挂载数据存储库以执行验证和还原操作。
* * SnapMirror 。 * SnapMirror 技术支持在内部和云中的 ONTAP 系统之间轻松快速地复制数据。SnapMirror 支持逻辑复制的版本灵活性以及块复制的性能，只会将更改后的数据发送到二级系统。可以使用镜像和 / 或存储策略保护数据，从而实现灾难恢复以及长期保留数据以进行备份。SnapMirror 支持异步和同步关系， ONTAP 9.8 引入了具有 SnapMirror 业务连续性的透明应用程序故障转移功能。
+
使用 Site Recovery Manager 进行 SRA 复制需要 SnapMirror 。此外， SnapCenter 还需要将 Snapshot 副本复制到二级存储系统。

* * SnapCenter 。 * SnapCenter 软件可提供一个统一的可扩展平台和插件套件，用于实现应用程序一致的数据保护和克隆管理。AFF 许可证随 FAS 和 SnapCenter 系统的数据保护许可证包一起提供。如果您使用的是以下存储系统： FAS ， AFF ， Cloud Volumes ONTAP 或 ONTAP Select ，则适用于 VMware vSphere 的 SnapCenter 插件是一款免费产品。但是，需要 SnapRestore 和 FlexClone 许可证。
* * MetroCluster 。 * NetApp MetroCluster 是一种同步复制解决方案，可将园区或城域的高可用性和灾难恢复相结合，以防止发生站点灾难和硬件中断。它提供的解决方案可以从故障中透明地恢复，实现零数据丢失（ 0 RPO ）和快速恢复（几分钟内即可完成 RTO ）。它在 vSphere 环境中用作 vSphere Metro Storage Cluster 配置的一部分。




== 适用于 ONTAP 的虚拟化工具

NetApp 提供了多种独立软件工具，可与 ONTAP 和 vSphere 结合使用来管理虚拟化环境。ONTAP 许可证附带了以下工具，无需额外付费。有关这些工具在 vSphere 环境中如何协同工作的说明，请参见图 1 。



=== 适用于 VMware vSphere 的 ONTAP 工具

适用于 VMware vSphere 的 ONTAP 工具是一组用于将 ONTAP 存储与 vSphere 结合使用的工具。无论您使用的是 SAN 还是 NAS ， vCenter 插件（以前称为 Virtual Storage Console （ VSC ））均可简化存储管理和效率功能，提高可用性并降低存储成本和运营开销。它使用最佳实践配置数据存储库，并为 NFS 和块存储环境优化 ESXi 主机设置。为了获得所有这些优势， NetApp 建议在将 vSphere 与运行 ONTAP 软件的系统结合使用时，最佳做法是使用这些 ONTAP 工具。它包括 vCenter 的服务器设备和用户界面扩展。



=== 适用于 VMware VAAI 的 NFS 插件

适用于 VMware 的 NetApp NFS 插件是 ESXi 主机的一个插件，可用于在 ONTAP 上对 NFS 数据存储库使用 VAAI 功能。它支持克隆操作的副本卸载，厚虚拟磁盘文件的空间预留以及 Snapshot 副本卸载。将副本操作卸载到存储不一定会更快完成，但它确实会卸载 CPU 周期，缓冲区和队列等主机资源。您可以使用适用于 VMware vSphere 的 ONTAP 工具在 ESXi 主机上安装此插件。



=== 适用于 ONTAP 的 VASA Provider

适用于 ONTAP 的 VASA Provider 支持 VMware vStorage APIs for Storage Awareness （ VASA ）框架。它作为适用于 VMware vSphere 的 ONTAP 工具的一部分提供，作为一个虚拟设备，易于部署。VASA Provider 可将 vCenter Server 与 ONTAP 连接起来，以帮助配置和监控 VM 存储。它支持 VMware 虚拟卷（ VVOL ）支持，管理存储功能配置文件和单个 VM VVOL 性能，并提供警报以监控容量和配置文件合规性。



=== Storage Replication Adapter

SRA 与 VMware Site Recovery Manager （ SRM ）结合使用，用于管理生产站点和灾难恢复站点之间的数据复制，并无中断地测试灾难恢复副本。它有助于自动执行发现，恢复和重新保护任务。它包括适用于 Windows SRM 服务器和 SRM 设备的 SRA 服务器设备和 SRA 适配器。SRA 作为适用于 VMware vSphere 的 ONTAP 工具的一部分提供。

下图显示了适用于 vSphere 的 ONTAP 工具。

image:vsphere_ontap_image1.png["错误：缺少图形映像"]
