---
sidebar: sidebar 
permalink: containers/rh-os-n_use_case_rosa_solution_snapshot_app.html 
keywords: OpenShift, OCP, Trident, NetApp ONTAP, Red Hat OpenShift Service on AWS, 
summary: 借助NetApp ONTAP在AWS上运行Red Hat OpenShift服务 
---
= 借助NetApp ONTAP在AWS上运行Red Hat OpenShift服务
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
**1.创建应用程序卷的快照**在本节中，我们将介绍如何创建与应用程序关联的卷的Trident快照。这将是应用程序数据的时间点副本。如果应用程序数据丢失、我们可以从此时间点副本恢复数据。注意：此快照与ONTAP中的原始卷存储在同一聚合中(内部或云中)。因此、如果ONTAP存储聚合丢失、我们将无法从其快照中恢复应用程序数据。

**…创建卷快照类将以下清单保存在名为volume-snapshot-class.yaml的文件中

[source]
----
apiVersion: snapshot.storage.k8s.io/v1
kind: VolumeSnapshotClass
metadata:
 name: fsx-snapclass
driver: csi.trident.netapp.io
deletionPolicy: Delete
----
使用上述清单创建快照。

image:redhat_openshift_container_rosa_image20.png["Snapshot类"]

** b.接下来，创建快照**通过创建卷快照创建现有PVC的快照，以创建PostgreSQL数据的时间点副本。这将创建FSx快照、该快照在文件系统后端几乎不占用任何空间。将以下清单保存在名为volume-Snapshot．yaml的文件中：

[source]
----
apiVersion: snapshot.storage.k8s.io/v1
kind: VolumeSnapshot
metadata:
 name: postgresql-volume-snap-01
spec:
 volumeSnapshotClassName: fsx-snapclass
 source:
   persistentVolumeClaimName: data-postgresql-0
----
** C.创建卷快照并确认已创建**

删除数据库以模拟数据丢失(由于各种原因可能会发生数据丢失、此处我们只是通过删除数据库来模拟它)

image:redhat_openshift_container_rosa_image21.png["卷快照"]

***删除数据库以模拟数据丢失(由于各种原因可能会发生数据丢失，此处我们只是通过删除数据库来模拟它)**

image:redhat_openshift_container_rosa_image22.png["数据库连接"]

image:redhat_openshift_container_rosa_image23.png["删除数据库"]
