---
sidebar: sidebar 
permalink: ehc/gcp-cvs-guest.html 
keywords: NetApp Solutions, google cloud, gcp, gcve, enterprise, hybrid, cloud, cloud volumes service, cvs 
summary:  
---
= 使用 VMware 引擎配置 Cloud Volumes Service
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


[role="lead"]
可以从 VMware 引擎环境中创建的 VM 挂载 Cloud Volumes Service 共享。由于 Cloud Volumes Service 支持 SMB 和 NFS 协议，因此这些卷也可以挂载到 Linux 客户端并映射到 Windows 客户端。可以通过简单的步骤设置 Cloud Volumes Service 卷。

Cloud Volume Service 和 Google Cloud VMware Engine 私有云必须位于同一区域。

要从 Google 云市场购买，启用和配置适用于 Google Cloud 的 NetApp Cloud Volumes Service ，请按照以下详细信息进行操作 link:https://cloud.google.com/vmware-engine/docs/quickstart-prerequisites["指南"]。



=== 创建一个 CVS NFS 卷到 GCVE 私有云

要创建和挂载 NFS 卷，请完成以下步骤：

. 从 Google 云控制台中的合作伙伴解决方案访问 Cloud Volumes 。
+
image:gcve-cvs-guest-1.png[""]

. 在 Cloud Volumes Console 中，转到 Volumes 页面，然后单击 Create 。
+
image:gcve-cvs-guest-2.png[""]

. 在创建文件系统页面上，根据成本分摊机制的需要指定卷名称和计费标签。
+
image:gcve-cvs-guest-3.png[""]

. 选择相应的服务。对于 GCVE ，请选择 CVS-Performance 和所需的服务级别，以根据应用程序工作负载要求提高延迟和性能。
+
image:gcve-cvs-guest-4.png[""]

. 为卷和卷路径指定 Google Cloud 区域（卷路径必须在项目中的所有云卷之间是唯一的）
+
image:gcve-cvs-guest-5.png[""]

. 选择卷的性能级别。
+
image:gcve-cvs-guest-6.png[""]

. 指定卷的大小和协议类型。在此测试中，将使用 NFSv3 。
+
image:gcve-cvs-guest-7.png[""]

. 在此步骤中，选择可从中访问卷的 VPC 网络。确保已建立 VPC 对等关系。
+
提示：如果尚未建立 VPC 对等关系，则会显示一个弹出按钮，用于指导您完成对等命令。打开 Cloud Shell 会话并执行相应的命令，将您的 VPC 与 Cloud Volumes Service 生产者建立对等关系。如果您决定事先准备 VPC 对等关系，请参见以下说明。

+
image:gcve-cvs-guest-8.png[""]

. 通过添加相应的规则来管理导出策略规则，然后选中相应 NFS 版本对应的复选框。
+
注意：除非添加导出策略，否则无法访问 NFS 卷。

+
image:gcve-cvs-guest-9.png[""]

. 单击保存以创建卷。
+
image:gcve-cvs-guest-10.png[""]





=== 将 NFS 导出挂载到在 VMware 引擎上运行的 VM

在准备挂载 NFS 卷之前，请确保专用连接的对等状态列为 "Active" 。状态为 "Active" 后，请使用 mount 命令。

要挂载 NFS 卷，请执行以下操作：

. 在 Cloud Console 中，转至 Cloud Volumes > Volumes 。
. 转到卷页面
. 单击要挂载 NFS 导出的 NFS 卷。
. 向右滚动，在显示更多下，单击挂载说明。


要从 VMware VM 的子操作系统中执行挂载过程，请执行以下步骤：

. 对虚拟机使用 SSH 客户端和 SSH 。
. 在实例上安装 NFS 客户端。
+
.. 在 Red Hat Enterprise Linux 或 SUSE Linux 实例上：
+
 sudo yum install -y nfs-utils
.. 在 Ubuntu 或 Debian 实例上：
+
 sudo apt-get install nfs-common


. 在实例上创建新目录，例如 "/nimCVSNFSol01" ：
+
 sudo mkdir /nimCVSNFSol01
+
image:gcve-cvs-guest-20.png[""]

. 使用相应的命令挂载卷。以下是实验室命令示例：
+
 sudo mount -t nfs -o rw,hard,rsize=65536,wsize=65536,vers=3,tcp 10.53.0.4:/nimCVSNFSol01 /nimCVSNFSol01
+
image:gcve-cvs-guest-21.png[""]
image:gcve-cvs-guest-22.png[""]





=== 创建 SMB 共享并将其挂载到在 VMware 引擎上运行的 VM

对于 SMB 卷，请确保在创建 SMB 卷之前已配置 Active Directory 连接。

image:gcve-cvs-guest-30.png[""]

建立 AD 连接后，创建具有所需服务级别的卷。除了选择适当的协议之外，这些步骤与创建 NFS 卷类似。

. 在 Cloud Volumes Console 中，转到 Volumes 页面，然后单击 Create 。
. 在创建文件系统页面上，根据成本分摊机制的需要指定卷名称和计费标签。
+
image:gcve-cvs-guest-31.png[""]

. 选择相应的服务。对于 GCVE ，请选择 CVS-Performance 和所需的服务级别，以根据工作负载要求提高延迟和性能。
+
image:gcve-cvs-guest-32.png[""]

. 为卷和卷路径指定 Google Cloud 区域（卷路径必须在项目中的所有云卷之间是唯一的）
+
image:gcve-cvs-guest-33.png[""]

. 选择卷的性能级别。
+
image:gcve-cvs-guest-34.png[""]

. 指定卷的大小和协议类型。在此测试中，使用 SMB 。
+
image:gcve-cvs-guest-35.png[""]

. 在此步骤中，选择可从中访问卷的 VPC 网络。确保已建立 VPC 对等关系。
+
提示：如果尚未建立 VPC 对等关系，则会显示一个弹出按钮，用于指导您完成对等命令。打开 Cloud Shell 会话并执行相应的命令，将您的 VPC 与 Cloud Volumes Service 生产者建立对等关系。如果您决定事先准备 VPC 对等关系，请参见以下内容 link:https://cloud.google.com/architecture/partners/netapp-cloud-volumes/setting-up-private-services-access?hl=en["说明"]。

+
image:gcve-cvs-guest-36.png[""]

. 单击保存以创建卷。
+
image:gcve-cvs-guest-37.png[""]



要挂载 SMB 卷，请执行以下操作：

. 在 Cloud Console 中，转至 Cloud Volumes > Volumes 。
. 转到卷页面
. 单击要映射 SMB 共享的 SMB 卷。
. 向右滚动，在显示更多下，单击挂载说明。


要从 VMware VM 的 Windows 子操作系统中执行挂载过程，请执行以下步骤：

. 单击 "Start （开始） " 按钮，然后单击 "Computer" （计算机）。
. 单击映射网络驱动器。
. 在驱动器列表中，单击任何可用的驱动器盘符。
. 在文件夹框中，键入：
+
 \\nimsmb-3830.nimgcveval.com\nimCVSMBvol01
+
image:gcve-cvs-guest-38.png[""]

+
要在每次登录到计算机时进行连接，请选中登录时重新连接复选框。

. 单击完成。
+
image:gcve-cvs-guest-39.png[""]


